import{j as e,m as z,A as te}from"./animations-w9Veu-LT.js";import{b as se,r as a,a as re}from"./vendor-BTukGEff.js";import{L as T,u as M,a as Y,R as ae,b as I,B as ne}from"./router-BMyDpNbE.js";import{i as ie,g as $,s as oe,G as W,b as le,o as V,a as ce,c as de}from"./firebase-BO4ffQYM.js";import{M as K,T as J,P as me,a as he,b as xe}from"./maps-CEsRGVXq.js";import{P as U,R as ue}from"./ui-C-GB4gVf.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))p(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&p(n)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function p(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();var q={},G=se;q.createRoot=G.createRoot,q.hydrateRoot=G.hydrateRoot;const ge={apiKey:"AIzaSyDi263BYC5vuqljXaEY_WPj_06gZdt9PqY",authDomain:"ride-along-a36bb.firebaseapp.com",projectId:"ride-along-a36bb",storageBucket:"ride-along-a36bb.appspot.com",messagingSenderId:"658827950786",appId:"1:658827950786:web:9c01fe7067e5601cbf995b"},pe=ie(ge),Q=$(pe);oe(Q,le).catch(console.error);new W;function X({onResults:d}){const[t,r]=a.useState(""),[p,s]=a.useState(""),[o,n]=a.useState(!1),b=async u=>{u.preventDefault(),n(!0);try{const l=new URLSearchParams;t&&l.append("from",t),p&&l.append("to",p);const j=await(await fetch(`https://ride-along-api.onrender.com/api/rides?${l}`)).json();d(j)}catch(l){console.error("❌ Search error:",l)}finally{n(!1)}};return e.jsxs("form",{onSubmit:b,className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"From"}),e.jsx("input",{type:"text",value:t,onChange:u=>r(u.target.value),placeholder:"e.g. Bareilly or Hapur",className:"w-full px-3 py-2 rounded-lg bg-zinc-700 text-white border border-zinc-600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"To"}),e.jsx("input",{type:"text",value:p,onChange:u=>s(u.target.value),placeholder:"e.g. Noida or Delhi",className:"w-full px-3 py-2 rounded-lg bg-zinc-700 text-white border border-zinc-600"})]}),e.jsx("button",{type:"submit",disabled:o,className:"bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-4 rounded-lg",children:o?"Searching...":"Search"})]})}function H({name:d,value:t,onChange:r,placeholder:p}){const[s,o]=a.useState(t||""),[n,b]=a.useState([]);a.useEffect(()=>{if(s.length<2)return b([]);const l=new AbortController;return fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${s}&accept-language=en`,{signal:l.signal,headers:{"User-Agent":"RideAlong/1.0"}}).then(c=>c.json()).then(c=>b(c)).catch(c=>console.log(c)),()=>l.abort()},[s]);const u=l=>{const c=l.display_name;o(c),b([]),r(d,c)};return e.jsxs("div",{className:"relative",children:[e.jsx("input",{value:s,onChange:l=>{const c=l.target.value;o(c),r(d,c)},placeholder:p,className:"input"}),n.length>0&&e.jsx("div",{className:"absolute z-10 bg-white text-black shadow-md rounded w-full max-h-48 overflow-y-auto",children:n.map((l,c)=>e.jsx("div",{onClick:()=>u(l),className:"px-4 py-2 hover:bg-purple-100 cursor-pointer",children:l.display_name},c))})]})}function Z({onPost:d}){const[t,r]=a.useState({from:"",to:"",via:"",price:"",seatsAvailable:"",driverName:"",driverContact:"",vehicleNumber:"",departureTime:""}),[p,s]=a.useState(!1),o=u=>{r({...t,[u.target.name]:u.target.value})},n=(u,l)=>{r(c=>({...c,[u]:l}))},b=async u=>{u.preventDefault(),s(!0);const l={...t,price:Number(t.price),seatsAvailable:Number(t.seatsAvailable),via:t.via?t.via.split(",").map(c=>c.trim()):[]};try{const c=$().currentUser;if(!c){alert("Please login to post a ride"),s(!1);return}const j=await c.getIdToken(),h=await fetch("https://ride-along-api.onrender.com/api/rides",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`},body:JSON.stringify(l)}),g=await h.json();console.log("PostRide response status:",h.status),console.log("PostRide payload:",g),h.ok?(alert("✅ Ride posted successfully!"),d?.(),r({from:"",to:"",via:"",price:"",seatsAvailable:"",driverName:"",driverContact:"",vehicleNumber:"",departureTime:""})):alert(`❌ Failed to post ride: ${g.error||"Unknown error"}`)}catch(c){console.error("❌ Caught error:",c),alert(`🚨 Error occurred: ${c.message}`)}s(!1)};return e.jsxs("form",{onSubmit:b,className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(H,{name:"from",placeholder:"From",value:t.from,onChange:n}),e.jsx(H,{name:"to",placeholder:"To",value:t.to,onChange:n}),e.jsx("input",{type:"text",name:"via",value:t.via,onChange:o,placeholder:"Via (comma-separated)",className:"input"}),e.jsx("input",{type:"number",name:"price",value:t.price,onChange:o,placeholder:"Price (₹)",required:!0,className:"input"}),e.jsx("input",{type:"number",name:"seatsAvailable",value:t.seatsAvailable,onChange:o,placeholder:"Seats Available",required:!0,className:"input"}),e.jsx("input",{type:"text",name:"driverName",value:t.driverName,onChange:o,placeholder:"Driver's Name",required:!0,className:"input"}),e.jsx("input",{type:"text",name:"driverContact",value:t.driverContact,onChange:o,placeholder:"Driver Contact",required:!0,className:"input"}),e.jsx("input",{type:"text",name:"vehicleNumber",value:t.vehicleNumber,onChange:o,placeholder:"Vehicle Number",required:!0,className:"input"}),e.jsx("input",{type:"datetime-local",name:"departureTime",value:t.departureTime,onChange:o,required:!0,className:"input"}),e.jsx("button",{type:"submit",disabled:p,className:"bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-4 rounded-lg",children:p?"Posting...":"Post Ride"})]})}function be(){const[d,t]=a.useState([]),[r,p]=a.useState(!1),s="https://ride-along-api.onrender.com/api/rides";a.useEffect(()=>{o()},[]);const o=async()=>{try{const b=await(await fetch(s)).json();t(b)}catch(n){console.error("Error fetching rides:",n)}};return e.jsxs(z.div,{className:"min-h-screen bg-zinc-900 text-white px-4 py-6",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-extrabold text-purple-400 tracking-tight",children:"Ride Along 🚗"}),e.jsx("p",{className:"text-zinc-400 mt-2 text-sm",children:"Post your route or join one on the way"})]}),e.jsxs(z.div,{className:"bg-zinc-800 p-4 rounded-xl shadow-lg mb-8",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-purple-300",children:"Search Rides"}),e.jsx(X,{onResults:t})]}),e.jsxs(z.div,{className:"bg-zinc-800 p-4 rounded-xl shadow-lg mb-8",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.3},children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-purple-300",children:"Offer a Ride"}),e.jsx("button",{onClick:()=>p(!r),className:"bg-purple-700 hover:bg-purple-800 text-white font-semibold px-4 py-2 rounded-lg",children:r?"Close Form":"Post a Ride"})]}),e.jsx(te,{children:r&&e.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx(Z,{onPost:o})})})]}),e.jsxs(z.div,{className:"bg-zinc-800 p-4 rounded-xl shadow-lg",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.4},children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-purple-300",children:"Recent Rides"}),d.length===0?e.jsx("p",{className:"text-zinc-400",children:"No rides found."}):e.jsx("ul",{className:"space-y-4",children:d.map(n=>e.jsx(z.li,{className:"bg-zinc-700 rounded-lg p-4 border border-zinc-600 hover:bg-zinc-600 transition",whileHover:{scale:1.02},children:e.jsxs(T,{to:`/ride/${n._id}`,className:"block space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-white",children:"From:"})," ",n.from]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-white",children:"To:"})," ",n.to]}),n.via&&n.via.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-white",children:"Via:"})," ",n.via.join(", ")]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-white",children:"Driver:"})," ",n.driverName]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-white",children:"Vehicle:"})," ",n.vehicleNumber]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-white",children:"Price:"})," ₹",n.price]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-white",children:"Seats:"}),e.jsx("span",{className:`font-bold ${n.seatsAvailable===0?"text-red-400":n.seatsAvailable<=2?"text-yellow-400":"text-green-400"}`,children:n.seatsAvailable}),n.seatsAvailable===0&&e.jsx("span",{className:"bg-red-600 text-white px-2 py-1 rounded text-xs font-bold",children:"FULLY BOOKED"}),n.seatsAvailable>0&&n.seatsAvailable<=2&&e.jsx("span",{className:"bg-yellow-600 text-white px-2 py-1 rounded text-xs font-bold",children:"FILLING FAST"})]}),e.jsxs("div",{className:"text-xs text-zinc-400 mt-2",children:[e.jsx("span",{className:"font-semibold",children:"Departure:"})," ",new Date(n.departureTime).toLocaleDateString()," at ",new Date(n.departureTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})},n._id))})]})]})}function je({from:d,to:t,via:r=[]}){const[p,s]=a.useState([]),[o,n]=a.useState([20.5937,78.9629]),b=async u=>{try{const c=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(u)}`)).json();return c.length===0?null:[parseFloat(c[0].lat),parseFloat(c[0].lon)]}catch(l){return console.error("Geocoding error:",l),null}};return a.useEffect(()=>{(async()=>{const l=[d,...r,t],j=(await Promise.all(l.map(b))).filter(Boolean);if(j.length<2)return;n(j[0]);const h=j.map(N=>`${N[1]},${N[0]}`).join(";"),w=await(await fetch(`https://router.project-osrm.org/route/v1/driving/${h}?overview=full&geometries=geojson`)).json();if(w.routes?.[0]?.geometry?.coordinates){const N=w.routes[0].geometry.coordinates.map(([A,k])=>[k,A]);s(N)}})()},[d,t,r]),e.jsx("div",{className:"h-64 mt-6 rounded-lg overflow-hidden",children:e.jsxs(K,{center:o,zoom:6,style:{height:"100%",width:"100%"},children:[e.jsx(J,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),p.length>0&&e.jsx(me,{positions:p,color:"purple",weight:5})]})})}function ee({rideId:d,onBookingSuccess:t,currentSeatsAvailable:r=1,ridePrice:p=0}){const[s,o]=a.useState({}),[n,b]=a.useState(!1),[u,l]=a.useState(""),[c,j]=a.useState(null),[h,g]=a.useState(1),w=M();a.useEffect(()=>{const f=JSON.parse(localStorage.getItem("profile"))||{};o(f)},[]);const N=f=>{o({...s,[f.target.name]:f.target.value}),u&&l("")},A=f=>{j(f),u&&l("")},k=()=>{const L=["name","email","phone","age","gender"].filter(S=>!s[S]?.trim());if(L.length>0)return l(`Please fill in all required fields: ${L.join(", ")}`),!1;if(!c)return l("Please verify you are not a robot."),!1;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email))return l("Please enter a valid email address."),!1;const E=parseInt(s.age);return E<16||E>120?(l("Age must be between 16 and 120 years."),!1):h<1||h>r?(l(`Please select between 1 and ${r} seats.`),!1):!0},y=async f=>{if(f.preventDefault(),b(!0),l(""),!k()){b(!1);return}const L=localStorage.getItem("uid"),R=localStorage.getItem("token");if(!L||!R){l("You must be logged in to book a ride. Please refresh the page and try again."),b(!1);return}try{const E=await fetch("https://ride-along-api.onrender.com/api/bookings",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${R}`},body:JSON.stringify({rideId:d,userId:L,userEmail:s.email,userName:s.name,userPhone:s.phone,userAge:parseInt(s.age),userGender:s.gender,seatsBooked:h,captcha:c})}),S=await E.json();if(E.ok){localStorage.setItem("profile",JSON.stringify(s));const P=S.emailResults?`📧 Email Status:
${S.emailResults.passengerEmailSent?"✅ Confirmation sent to you":"❌ Your confirmation failed"}
${S.emailResults.driverEmailSent?"✅ Driver notified":"❌ Driver notification failed"}`:"📧 Email notifications processed";alert(`✅ Booking successful! 
        
🎫 ${h} seat(s) booked
🚗 ${S.remainingSeats} seats remaining

${P}

You will be redirected to the booking confirmation page.`),t&&t(),w(`/booking-success/${d}`)}else l(S.error||S.message||"Booking failed!"),j(null),window.grecaptcha?.reset()}catch(E){console.error("Booking error:",E),l("Network error. Please check your connection and try again."),j(null),window.grecaptcha?.reset()}finally{b(!1)}};return e.jsxs("form",{onSubmit:y,className:"space-y-4 bg-zinc-800 p-6 rounded-xl shadow-2xl max-w-lg mx-auto text-white border border-blue-500 backdrop-blur-md",children:[e.jsx("h2",{className:"text-2xl font-bold text-center",children:"Book This Ride"}),u&&e.jsx("p",{className:"text-red-400 text-sm bg-red-900/20 border border-red-500 p-3 rounded text-center",children:u}),e.jsx("input",{name:"name",type:"text",value:s.name||"",onChange:N,placeholder:"Full Name *",className:"w-full p-2 rounded text-black",required:!0}),e.jsx("input",{name:"age",type:"number",min:"18",max:"120",value:s.age||"",onChange:N,placeholder:"Age (18+) *",className:"w-full p-2 rounded text-black",required:!0}),e.jsxs("select",{name:"gender",value:s.gender||"",onChange:N,className:"w-full p-2 rounded text-black",required:!0,children:[e.jsx("option",{value:"",children:"Select Gender *"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer-not-to-say",children:"Prefer not to say"})]}),e.jsx("input",{name:"email",type:"email",value:s.email||"",onChange:N,placeholder:"Email *",className:"w-full p-2 rounded text-black",required:!0}),e.jsx("input",{name:"phone",type:"tel",value:s.phone||"",onChange:N,placeholder:"Phone Number *",className:"w-full p-2 rounded text-black",required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 text-purple-300",children:"Number of Seats *"}),e.jsx("select",{value:h,onChange:f=>{g(parseInt(f.target.value)),u&&l("")},className:"w-full p-2 rounded text-black",required:!0,children:Array.from({length:r},(f,L)=>L+1).map(f=>e.jsxs("option",{value:f,children:[f," seat",f>1?"s":""," ",p>0?`- ₹${f*p}`:""]},f))}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[r," seat",r>1?"s":""," available",p>0&&h>0&&e.jsxs("span",{className:"text-green-400 font-semibold ml-2",children:["Total: ₹",h*p]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(ue,{sitekey:"6LdlI4UrAAAAAFDXPMbQCK7lo79hzsr1AkB_Acyb",onChange:A,theme:"dark"})}),e.jsx("button",{type:"submit",className:"bg-green-500 px-4 py-2 rounded hover:bg-green-600 w-full disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]}),"Booking..."]}):`Confirm Booking (${h} seat${h>1?"s":""})`})]})}ee.propTypes={rideId:U.string.isRequired,onBookingSuccess:U.func,currentSeatsAvailable:U.number,ridePrice:U.number};function fe(){const{id:d}=Y(),[t,r]=a.useState(null),[p,s]=a.useState(!0),[o,n]=a.useState(null),[b,u]=a.useState(!1),[l,c]=a.useState(!1),h=$().currentUser,g=`https://ride-along-api.onrender.com/api/rides/${d}`,w=async()=>{try{const S=await fetch(g);if(!S.ok)throw new Error("Ride not found");const P=await S.json();r(P),h&&N(h.uid)}catch(S){n(S.message)}finally{s(!1)}},N=async S=>{try{const P=await fetch(`https://ride-along-api.onrender.com/api/bookings/user/${S}`);if(P.ok){const B=(await P.json()).some(D=>D.rideId&&D.rideId._id===d);c(B)}}catch(P){console.error("Error checking user booking:",P)}};a.useEffect(()=>{w()},[d]);const A=()=>{s(!0),w(),u(!1),c(!0)},k=t?.seatsAvailable===0,y=h&&t?.userId===h.uid,f=!!h,L=y||l,R=()=>f?y?"Your Ride":l?"Already Booked":k?"All Seats Booked":`Book Now (${t?.seatsAvailable} seats left)`:"Login to Book",E=()=>!f||y||k||l?"bg-gray-600 cursor-not-allowed opacity-50":"bg-blue-600 hover:bg-blue-700 transition-all";return p?e.jsx("p",{className:"text-center mt-10 text-blue-300 animate-pulse",children:"Loading..."}):o?e.jsxs("p",{className:"text-center mt-10 text-red-400",children:["Error: ",o]}):e.jsxs("div",{className:"min-h-screen bg-zinc-900 text-white p-6 relative",children:[e.jsx("h1",{className:"text-3xl font-bold text-purple-400 mb-6",children:"Ride Details"}),e.jsxs("div",{className:"bg-zinc-800 rounded-xl p-6 shadow-lg space-y-4 text-lg",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"From:"})," ",t.from]}),e.jsxs("div",{children:[e.jsx("strong",{children:"To:"})," ",t.to]}),t.via&&t.via.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Via:"})," ",t.via.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Price:"})," ₹",t.price]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("strong",{children:"Seats Available:"}),e.jsx("span",{className:`font-bold ${k?"text-red-400":"text-green-400"}`,children:t.seatsAvailable}),k&&e.jsx("span",{className:"bg-red-600 text-white px-2 py-1 rounded text-sm font-bold",children:"FULLY BOOKED"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Departure Time:"})," ",new Date(t.departureTime).toLocaleString()]}),e.jsxs("div",{className:"bg-zinc-700 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-300 mb-3",children:"Driver Information"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Driver Name:"})," ",t.driverName]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:`${L?"":"filter blur-sm"}`,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Contact:"})," ",t.driverContact]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Vehicle Number:"})," ",t.vehicleNumber]})]}),!L&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-zinc-700 bg-opacity-80 rounded",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-blue-400 font-semibold mb-1",children:"🔒 Book to see details"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Contact and vehicle details will be revealed after booking"})]})})]}),L&&e.jsx("div",{className:"mt-3 p-2 bg-green-900 bg-opacity-30 rounded border border-green-500",children:e.jsxs("div",{className:"text-green-400 text-sm",children:["✅ You can see all details because you have ",y?"posted this ride":"booked this ride"]})})]}),e.jsx("div",{className:"mt-10 z-0 relative",children:e.jsx(je,{from:t.from,to:t.to,via:t.via})}),e.jsxs("div",{className:"mt-6 text-center",children:[e.jsx("button",{onClick:()=>{if(!f){alert("Please login to book a ride");return}if(y){alert("You cannot book your own ride");return}if(l){alert("You have already booked this ride");return}if(k){alert("This ride is fully booked");return}u(!0)},disabled:!f||y||k||l,className:`${E()} px-5 py-2 rounded-xl font-bold text-white`,children:R()}),!f&&e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Please login to book this ride"}),y&&e.jsx("p",{className:"text-sm text-blue-400 mt-2",children:"This is your posted ride"}),l&&e.jsx("p",{className:"text-sm text-green-400 mt-2",children:"You have already booked this ride"}),k&&e.jsx("p",{className:"text-sm text-red-400 mt-2",children:"All seats have been booked for this ride"})]}),e.jsxs("div",{className:"text-sm text-zinc-400 mt-2",children:[e.jsx("strong",{children:"Posted:"})," ",new Date(t.createdAt).toLocaleString()]})]}),b&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70",children:e.jsxs("div",{className:"bg-zinc-800 p-6 rounded-xl w-[90%] max-w-xl shadow-2xl relative",children:[e.jsx("button",{onClick:()=>u(!1),className:"absolute top-2 right-3 text-red-400 hover:text-red-600 text-2xl",children:"×"}),e.jsx("h2",{className:"text-2xl font-semibold text-purple-400 mb-4",children:"Complete your Booking"}),e.jsx(ee,{rideId:d,onBookingSuccess:A,currentSeatsAvailable:t?.seatsAvailable,ridePrice:t?.price})]})})]})}function ye(){const t=$().currentUser,[r,p]=a.useState({uid:"",name:"",age:"",gender:"",phone:"",email:""}),[s,o]=a.useState(!0),[n,b]=a.useState(!1),[u,l]=a.useState({}),[c,j]=a.useState([]),[h,g]=a.useState([]),[w,N]=a.useState(!0),[A,k]=a.useState(!0),y="https://ride-along-api.onrender.com/api/users",f="https://ride-along-api.onrender.com/api/rides",L="https://ride-along-api.onrender.com/api/bookings";a.useEffect(()=>{if(!t)return;const i=async()=>{try{const m=await fetch(`${y}/${t.uid}`);if(m.ok){const v=await m.json();p({...v,uid:t.uid})}else p(v=>({...v,uid:t.uid,email:t.email||"",name:t.displayName||""}))}catch(m){console.error("Fetch failed:",m)}finally{o(!1)}},C=async()=>{try{const m=await fetch(`${f}/user/${t.uid}`);if(m.ok){const v=await m.json();g(v)}}catch(m){console.error("Failed to fetch user rides:",m)}finally{N(!1)}},x=async()=>{try{const m=await fetch(`${L}/user/${t.uid}`);if(m.ok){const v=await m.json();j(v)}}catch(m){console.error("Failed to fetch user bookings:",m)}finally{k(!1)}};i(),C(),x()},[t]);const R=()=>{const i={};return r.name||(i.name="Name is required"),(!r.age||r.age<1)&&(i.age="Enter a valid age"),r.gender||(i.gender="Select your gender"),/^\d{10}$/.test(r.phone)||(i.phone="Enter a 10-digit phone number"),/^\S+@\S+.\S+$/.test(r.email)||(i.email="Invalid email format"),l(i),Object.keys(i).length===0},E=i=>{const{name:C,value:x}=i.target;p(m=>({...m,[C]:x})),l(m=>({...m,[C]:""}))},S=async()=>{if(R())try{(await fetch(`${y}/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok&&(b(!0),setTimeout(()=>b(!1),2e3))}catch(i){console.error("Save failed:",i)}},P=async i=>{const C=localStorage.getItem("token");if(!C){alert("Please login to cancel bookings");return}if(confirm("Are you sure you want to cancel this booking?"))try{const x=await fetch(`${L}/${i}`,{method:"DELETE",headers:{Authorization:`Bearer ${C}`}});if(x.ok)j(m=>m.filter(v=>v._id!==i)),alert("Booking cancelled successfully!");else{const m=await x.json();alert(m.error||"Failed to cancel booking")}}catch(x){console.error("Failed to cancel booking:",x),alert("Network error. Please try again.")}},F=async i=>{const C=localStorage.getItem("token");if(!C){alert("Please login to delete rides");return}if(confirm("Are you sure you want to delete this ride? This action cannot be undone."))try{const x=await fetch(`${f}/${i}`,{method:"DELETE",headers:{Authorization:`Bearer ${C}`}});if(x.ok)g(m=>m.filter(v=>v._id!==i)),alert("Ride deleted successfully!");else{const m=await x.json();alert(m.error||"Failed to delete ride")}}catch(x){console.error("Failed to delete ride:",x),alert("Network error. Please try again.")}},B=i=>new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),D=i=>{const C=new Date(i);return{date:C.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),time:C.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}};return s?e.jsx("div",{className:"text-center mt-10 text-white",children:"Loading..."}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-zinc-900 to-zinc-800 text-white p-4 sm:p-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-purple-400 mb-6 text-center",children:"Your Profile"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 max-w-7xl mx-auto",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-zinc-800 p-4 sm:p-6 rounded-2xl shadow-2xl border border-zinc-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-purple-300 mb-4",children:"Profile Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 text-purple-300",children:"UID"}),e.jsx("input",{name:"uid",type:"text",value:r.uid,readOnly:!0,className:"w-full px-3 py-2 rounded-lg bg-zinc-700 text-white border border-zinc-600 opacity-80 cursor-not-allowed text-sm"})]}),["name","age","phone","email"].map(i=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 capitalize text-purple-300",children:i}),e.jsx("input",{name:i,type:i==="age"?"number":"text",value:r[i]||"",onChange:E,className:`w-full px-3 py-2 rounded-lg bg-zinc-700 text-white border focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm ${u[i]?"border-red-500":"border-zinc-600"}`}),u[i]&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:u[i]})]},i)),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 text-purple-300",children:"Gender"}),e.jsxs("select",{name:"gender",value:r.gender,onChange:E,className:`w-full px-3 py-2 rounded-lg bg-zinc-700 text-white border appearance-none focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm ${u.gender?"border-red-500":"border-zinc-600"}`,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]}),u.gender&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:u.gender})]}),e.jsx("button",{onClick:S,className:"w-full bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg font-semibold transition duration-200 ease-in-out text-sm",children:"Save Changes"}),n&&e.jsx("p",{className:"text-green-400 text-center animate-pulse mt-2 text-sm",children:"✅ Profile updated successfully"})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-zinc-800 p-4 sm:p-6 rounded-2xl shadow-2xl border border-zinc-700",children:[e.jsxs("h2",{className:"text-xl font-semibold text-blue-300 mb-4",children:["My Bookings (",c.length,")"]}),A?e.jsx("div",{className:"text-center text-gray-400",children:"Loading bookings..."}):c.length===0?e.jsxs("div",{className:"text-center text-gray-400 py-8",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📅"}),e.jsx("p",{children:"No bookings yet"}),e.jsx("p",{className:"text-sm",children:"Book your first ride to see it here!"})]}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:c.map(i=>e.jsxs("div",{className:"bg-zinc-700 p-3 rounded-lg border border-zinc-600",children:[e.jsx("div",{className:"flex justify-between items-start mb-2",children:e.jsx("div",{className:"flex-1 min-w-0",children:i.rideId?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-sm font-medium text-white truncate",children:[i.rideId.from," → ",i.rideId.to]}),e.jsxs("div",{className:"text-xs text-gray-400",children:[i.rideId.departureTime?D(i.rideId.departureTime).date:"N/A"," at ",i.rideId.departureTime?D(i.rideId.departureTime).time:"N/A"]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Seats: ",i.seatsBooked," | Booked: ",B(i.bookedAt)]}),e.jsxs("div",{className:"text-xs text-green-400",children:["₹",i.rideId.price," total for ",i.seatsBooked," seat(s)"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm font-medium text-red-400",children:"Ride no longer available"}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Seats: ",i.seatsBooked," | Booked: ",B(i.bookedAt)]}),e.jsx("div",{className:"text-xs text-yellow-400",children:"Original ride may have been deleted"})]})})}),e.jsx("button",{onClick:()=>P(i._id),className:"w-full bg-red-600 hover:bg-red-700 text-white py-1 px-2 rounded text-xs transition duration-200",children:"Cancel Booking"})]},i._id))})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-zinc-800 p-4 sm:p-6 rounded-2xl shadow-2xl border border-zinc-700",children:[e.jsxs("h2",{className:"text-xl font-semibold text-green-300 mb-4",children:["My Posted Rides (",h.length,")"]}),w?e.jsx("div",{className:"text-center text-gray-400",children:"Loading rides..."}):h.length===0?e.jsxs("div",{className:"text-center text-gray-400 py-8",children:[e.jsx("div",{className:"text-4xl mb-2",children:"🚗"}),e.jsx("p",{children:"No rides posted yet"}),e.jsx("p",{className:"text-sm",children:"Post your first ride to see it here!"})]}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:h.map(i=>e.jsxs("div",{className:"bg-zinc-700 p-3 rounded-lg border border-zinc-600",children:[e.jsx("div",{className:"flex justify-between items-start mb-2",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-sm font-medium text-white truncate",children:[i.from," → ",i.to]}),e.jsxs("div",{className:"text-xs text-gray-400",children:[i.departureTime?D(i.departureTime).date:"N/A"," at ",i.departureTime?D(i.departureTime).time:"N/A"]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Seats Available: ",i.seatsAvailable]}),e.jsxs("div",{className:"text-xs text-green-400",children:["₹",i.price," per ride"]}),i.via&&i.via.length>0&&e.jsxs("div",{className:"text-xs text-blue-400",children:["Via: ",i.via.join(", ")]})]})}),e.jsx("button",{onClick:()=>F(i._id),className:"w-full bg-red-600 hover:bg-red-700 text-white py-1 px-2 rounded text-xs transition duration-200",children:"Delete Ride"})]},i._id))})]})})]})]})}function ve(){const[d,t]=a.useState(null),[r,p]=a.useState(null),[s]=a.useState([{name:"Emergency Services",number:"112",icon:"🚨",description:"Universal emergency number"},{name:"Roadside Assistance",number:"1033",icon:"🔧",description:"Vehicle breakdown help"}]),[o,n]=a.useState(""),[b,u]=a.useState(!1),[l,c]=a.useState(!1),[j,h]=a.useState(null),[g,w]=a.useState(null),[N,A]=a.useState(null),y=$().currentUser;a.useEffect(()=>{L()},[]);const f=async(x,m)=>{try{const O=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${x}&lon=${m}&zoom=18&addressdetails=1`)).json();O&&O.display_name?A(O.display_name):A("Location name not available")}catch(v){console.error("Error getting place name:",v),A("Unable to get location name")}},L=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(async x=>{const m={lat:x.coords.latitude,lng:x.coords.longitude};t(m),await f(m.lat,m.lng)},x=>{p("Unable to get your location. Please enable location services."),console.error("Location error:",x)}):p("Geolocation is not supported by this browser.")},R=x=>{window.location.href=`tel:${x}`},E=()=>{const x=navigator.userAgent.toLowerCase();x.includes("iphone")||x.includes("ipad")?alert(`📱 iPhone Emergency SOS:

Method 1: Press and hold Side button + Volume button
Method 2: Press Side button 5 times rapidly
Method 3: Use Emergency SOS in Control Center

This will automatically call emergency services and notify your emergency contacts.`):x.includes("android")?alert(`📱 Android Emergency SOS:

Method 1: Press Power button 5 times rapidly
Method 2: Use Emergency button on lock screen
Method 3: Say "Hey Google, call emergency services"

Check your phone's Emergency SOS settings for more options.`):alert(`📱 Phone Emergency Features:

• Check your phone's Emergency/SOS settings
• Most phones: Press power button multiple times
• Use voice assistant: "Call emergency services"
• Emergency contacts are usually accessible from lock screen`)},S=()=>{if(d){const x=`https://maps.google.com/maps?q=${d.lat},${d.lng}`;navigator.share?navigator.share({title:"My Current Location - Emergency",text:"I need help! This is my current location:",url:x}):navigator.clipboard.writeText(`Emergency! I'm at: ${x}`).then(()=>{alert("Location copied to clipboard! Share this with someone who can help.")})}else alert("Location not available. Please enable location services.")},P=async x=>{const m=Date.now().toString(36)+Math.random().toString(36).substr(2);try{const v=await fetch("https://ride-along-api.onrender.com/api/live-location",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:m,userId:y?.uid,userName:y?.displayName||"Anonymous User",userEmail:y?.email||"unknown@email.com",location:x,placeName:N||"",message:o||"",accuracy:"High"})});if(v.ok){const O=await v.json(),_=`${window.location.origin}/live-location/${m}`;return w(_),console.log("✅ Live location session created:",O),_}else throw new Error("Failed to create live location session")}catch(v){console.error("❌ Error creating live location session:",v);const O=`${window.location.origin}/live-location/${m}`;return w(O),O}},F=async x=>{if(!g)return;const m=g.split("/").pop();try{(await fetch("https://ride-along-api.onrender.com/api/live-location",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:m,userId:y?.uid,userName:y?.displayName||"Anonymous User",userEmail:y?.email||"unknown@email.com",location:x,placeName:N||"",message:o||"",accuracy:"High"})})).ok?console.log("✅ Live location updated successfully"):console.error("❌ Failed to update live location")}catch(v){console.error("❌ Error updating live location:",v)}},B=()=>{if(!navigator.geolocation){alert("Geolocation is not supported by this browser.");return}c(!0),d&&P(d);const x=setInterval(()=>{navigator.geolocation.getCurrentPosition(async m=>{const v={lat:m.coords.latitude,lng:m.coords.longitude,timestamp:new Date().toISOString()};t(v),await f(v.lat,v.lng),g?await F(v):await P(v),console.log("Live location update:",v)},m=>{console.error("Live location error:",m)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},3e4);h(x),alert("Live location sharing started! Your location will be updated every 30 seconds.")},D=async()=>{if(j&&(clearInterval(j),h(null)),g&&y){const x=g.split("/").pop();try{await fetch(`https://ride-along-api.onrender.com/api/live-location/${x}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:y.uid})}),console.log("✅ Live location session stopped")}catch(m){console.error("❌ Error stopping live location session:",m)}}c(!1),w(null),alert("Live location sharing stopped.")},i=()=>{g&&navigator.clipboard.writeText(g).then(()=>{alert("Shareable link copied to clipboard! Send this to people who need to track your location.")}).catch(()=>{alert("Unable to copy link. Please copy manually: "+g)})};a.useEffect(()=>()=>{j&&clearInterval(j)},[j]);const C=async()=>{u(!0);const x={userId:y?.uid,userName:y?.displayName||"Unknown User",userEmail:y?.email,location:d,message:o,timestamp:new Date().toISOString(),type:"SOS_ALERT"};try{console.log("SOS Alert:",x),alert("SOS Alert sent! Emergency services and your emergency contacts have been notified.")}catch(m){console.error("Failed to send SOS alert:",m),alert("Failed to send SOS alert. Please try calling emergency services directly.")}u(!1)};return e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-red-600 text-2xl mr-3",children:"🆘"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-red-800",children:"Emergency SOS"}),e.jsx("p",{className:"text-red-700",children:"Quick access to emergency services and safety features"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6 border-2 border-red-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-800 mb-2",children:"📱 Use Your Phone's Emergency SOS"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Activate your phone's built-in emergency features that will automatically call emergency services and notify your emergency contacts"}),e.jsx("button",{onClick:E,className:"bg-red-600 hover:bg-red-700 text-white font-bold text-xl px-8 py-4 rounded-lg transition duration-200 shadow-lg",children:"🆘 ACTIVATE PHONE SOS"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This will show you how to use your phone's native emergency features"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Quick Dial Emergency Numbers"}),e.jsx("div",{className:"space-y-3",children:s.map((x,m)=>e.jsxs("button",{onClick:()=>R(x.number),className:"w-full flex items-center justify-between p-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition duration-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-2xl mr-3",children:x.icon}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold",children:x.name}),e.jsx("div",{className:"text-red-200 text-sm",children:x.number}),e.jsx("div",{className:"text-red-100 text-xs",children:x.description})]})]}),e.jsx("span",{className:"text-xl",children:"📞"})]},m))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Location & SOS Alert"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-2 flex items-center justify-between",children:[e.jsx("span",{children:"Your Current Location:"}),l&&e.jsxs("span",{className:"text-green-600 text-xs flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-1 animate-pulse"}),"Live Sharing Active"]})]}),d?e.jsx("div",{className:"bg-green-50 p-3 rounded border border-green-200",children:e.jsxs("div",{className:"text-green-800 text-sm",children:[N&&e.jsxs("div",{className:"font-semibold mb-2 text-green-700",children:["📍 ",N]}),e.jsxs("div",{className:"font-mono text-xs",children:["Lat: ",d.lat.toFixed(6),e.jsx("br",{}),"Lng: ",d.lng.toFixed(6)]}),d.timestamp&&e.jsxs("div",{className:"text-green-600 text-xs mt-1",children:["Updated: ",new Date(d.timestamp).toLocaleTimeString()]})]})}):e.jsx("div",{className:"bg-yellow-50 p-3 rounded border border-yellow-200",children:e.jsx("div",{className:"text-yellow-800 text-sm",children:r||"Getting your location..."})})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsx("button",{onClick:S,disabled:!d,className:"w-full p-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition duration-200",children:"📍 Share Current Location"}),l?e.jsx("button",{onClick:D,className:"w-full p-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition duration-200",children:"⏹️ Stop Live Location Sharing"}):e.jsx("button",{onClick:B,disabled:!d,className:"w-full p-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition duration-200",children:"🔴 Start Live Location Sharing"})]}),l&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-4",children:[e.jsxs("div",{className:"text-green-800 text-sm",children:[e.jsx("strong",{children:"Live sharing active:"})," Your location is being updated every 30 seconds. This helps emergency responders track your real-time position."]}),g&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-green-300",children:[e.jsx("div",{className:"text-green-700 font-semibold text-sm mb-2",children:"🔗 Shareable Live Location Link:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:g,readOnly:!0,className:"flex-1 p-2 text-xs bg-white border border-green-300 rounded font-mono"}),e.jsx("button",{onClick:i,className:"bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded text-xs transition duration-200",children:"📋 Copy"})]}),e.jsx("div",{className:"text-green-600 text-xs mt-1",children:"Share this link with emergency contacts to let them track your live location"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Emergency Message (Optional):"}),e.jsx("textarea",{value:o,onChange:x=>n(x.target.value),placeholder:"Describe your emergency or situation...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",rows:"3"})]}),e.jsx("button",{onClick:C,disabled:b||!y,className:"w-full p-4 bg-red-600 text-white font-bold text-lg rounded-lg hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition duration-200",children:b?"SENDING SOS...":"🆘 SEND SOS ALERT"}),!y&&e.jsx("p",{className:"text-red-600 text-sm mt-2 text-center",children:"Please log in to send SOS alerts"})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg shadow-md p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-blue-800",children:"📱 Setup Your Phone's Emergency Features"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[e.jsxs("h3",{className:"font-semibold text-gray-700 mb-3 flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"📱"})," iPhone Setup"]}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-2",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Settings → Emergency SOS"})]}),e.jsx("li",{children:'• Enable "Call with Side Button"'}),e.jsx("li",{children:"• Add emergency contacts in Health app"}),e.jsx("li",{children:'• Enable "Share During Emergency Call"'}),e.jsx("li",{children:"• Test: Press Side + Volume button"})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[e.jsxs("h3",{className:"font-semibold text-gray-700 mb-3 flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2",children:"🤖"})," Android Setup"]}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-2",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Settings → Safety & Emergency"})]}),e.jsx("li",{children:"• Setup Emergency SOS"}),e.jsx("li",{children:"• Add emergency contacts"}),e.jsx("li",{children:"• Enable location sharing"}),e.jsx("li",{children:"• Test: Press Power button 5 times"})]})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"💡 Tip:"})," Set up your emergency contacts in your phone's settings before you need them. Most modern phones can automatically call emergency services and send your location to trusted contacts."]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Safety Tips"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"🚗 During Rides:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Share your trip details with someone you trust"}),e.jsx("li",{children:"• Keep your phone charged and accessible"}),e.jsx("li",{children:"• Trust your instincts - if something feels wrong, speak up"}),e.jsx("li",{children:"• Keep emergency contacts readily available"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"📱 Phone Emergency Features:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• Set up emergency contacts in your phone"}),e.jsx("li",{children:"• Enable location sharing for emergencies"}),e.jsx("li",{children:"• Practice using your phone's SOS feature"}),e.jsx("li",{children:"• Keep your phone charged and accessible"}),e.jsx("li",{children:"• Know how to quickly access emergency dialer"})]})]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-6 mt-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-blue-800",children:"Be Prepared"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl mb-2",children:"🔋"}),e.jsx("h4",{className:"font-semibold text-gray-700",children:"Keep Device Charged"}),e.jsx("p",{className:"text-gray-600",children:"Ensure your phone battery is charged before traveling"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl mb-2",children:"👥"}),e.jsx("h4",{className:"font-semibold text-gray-700",children:"Inform Others"}),e.jsx("p",{className:"text-gray-600",children:"Let friends/family know your travel plans"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl mb-2",children:"🗺️"}),e.jsx("h4",{className:"font-semibold text-gray-700",children:"Know Your Route"}),e.jsx("p",{className:"text-gray-600",children:"Familiarize yourself with the planned route"})]})]})]})]})}function Ne(){return e.jsxs("div",{className:"p-6 text-white bg-zinc-900 min-h-screen",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-purple-400",children:"Terms & Conditions"}),e.jsxs("div",{className:"text-zinc-300 leading-relaxed space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-purple-300",children:"1. Eligibility"}),e.jsxs("p",{className:"mt-2",children:["You must be at least ",e.jsx("strong",{className:"text-green-400",children:"16 years old"})," to use Ride Along. You are solely responsible for keeping your login credentials safe."]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-purple-300",children:"2. Posting & Booking Rides"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"All ride details must be accurate and up-to-date."}),e.jsx("li",{children:"Passengers must respect the driver’s instructions."}),e.jsx("li",{children:"Fake rides, spamming, or abuse may lead to a permanent ban."})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-purple-300",children:"3. Content Ownership"}),e.jsx("p",{className:"mt-2",children:"You retain ownership of your data. By submitting ride or profile info, you grant Ride Along permission to use it solely for delivering platform services."})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-purple-300",children:"4. Limitations"}),e.jsxs("p",{className:"mt-2",children:["Ride Along is only a platform. We do ",e.jsx("span",{className:"text-red-400 font-semibold",children:"not control"})," drivers, passengers, or vehicles. Use the service at your own discretion and risk."]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-purple-300",children:"5. Modifications"}),e.jsx("p",{className:"mt-2",children:"We may update these terms from time to time. Continued use after changes means you agree to the updated terms."})]})]})]})}function we(){return e.jsxs("div",{className:"p-6 text-white bg-zinc-900 min-h-screen",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-purple-400",children:"Privacy Policy"}),e.jsxs("div",{className:"text-zinc-300 leading-relaxed space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-purple-300",children:"1. Information We Collect"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Name, email, phone, age, gender, and other profile details."}),e.jsx("li",{children:"Location and ride data you submit or browse."}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-yellow-400",children:"Real-time location data"})," when you use our SOS emergency features and live location sharing."]}),e.jsx("li",{children:"Place names and addresses derived from your location coordinates."}),e.jsx("li",{children:"Technical info like IP address, device type, etc."})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-purple-300",children:"2. How We Use It"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"To provide and improve the ride-sharing experience."}),e.jsx("li",{children:"For user support, communication, and safety purposes."}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-red-400",children:"Emergency location tracking"})," to help emergency responders locate you when you activate SOS features."]}),e.jsx("li",{children:"To generate shareable location links for emergency contacts when you choose to share your live location."}),e.jsx("li",{children:"To display readable place names alongside coordinates for better location identification."}),e.jsx("li",{children:"To comply with legal obligations."})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-purple-300",children:"3. Data Sharing"}),e.jsxs("p",{className:"mt-2",children:["We ",e.jsx("strong",{className:"text-green-400",children:"do not sell or trade"})," your data."]}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Shared with drivers or passengers (only when you book or post a ride)."}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-orange-400",children:"Emergency location data"})," may be shared with emergency services and your designated emergency contacts when you activate SOS features."]}),e.jsx("li",{children:"Live location data is shared only through links you generate and choose to share with trusted contacts."}),e.jsx("li",{children:"Used by trusted third-party services like Firebase, OpenStreetMap (for place names), or analytics tools."}),e.jsx("li",{children:"Shared if required by law."})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-purple-300",children:"4. Your Choices"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"You can edit or delete your profile anytime."}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-cyan-400",children:"Location tracking"})," is only active when you explicitly start live location sharing and can be stopped at any time."]}),e.jsx("li",{children:"You control who receives your shareable location links - we never share them without your consent."}),e.jsx("li",{children:"SOS features only activate when you deliberately use them for emergencies."}),e.jsx("li",{children:"You can contact us for complete account deletion."})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-purple-300",children:"5. SOS & Emergency Features"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsx("p",{children:"Our SOS features are designed for emergency situations and involve special data handling:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{className:"text-red-400",children:"Real-time location tracking:"})," When activated, your location updates every 30 seconds."]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-yellow-400",children:"Shareable links:"})," Generate unique URLs to share your live location with trusted contacts."]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-blue-400",children:"Place name resolution:"})," We use OpenStreetMap to convert coordinates to readable addresses."]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-green-400",children:"Emergency contact integration:"})," Works with your phone's native emergency features."]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-purple-400",children:"Data retention:"})," Location tracking stops when you deactivate it or close the session."]})]}),e.jsxs("p",{className:"text-orange-300 text-sm mt-2",children:[e.jsx("strong",{children:"Important:"})," SOS features are for genuine emergencies. Misuse may result in account suspension."]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-purple-300",children:"6. Security"}),e.jsxs("p",{className:"mt-2",children:["We use secure encryption, Firebase Authentication, and protected servers to keep your data ",e.jsx("span",{className:"text-green-400 font-semibold",children:"safe"}),"."]})]})]})]})}function Se(){return e.jsxs("div",{className:"p-6 text-white bg-zinc-900 min-h-screen",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-purple-400",children:"Refund & Contact"}),e.jsxs("div",{className:"text-zinc-300 leading-relaxed space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-purple-300",children:"Refund Policy"}),e.jsxs("p",{className:"mt-2",children:["Ride Along is a ",e.jsx("strong",{className:"text-yellow-400",children:"free-to-use platform"})," for ride coordination. We do not handle payments directly, so ",e.jsx("span",{className:"text-red-400 font-semibold",children:"no refunds"})," are processed by us. If you've made a payment outside the platform, please contact the respective driver or passenger directly."]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg text-purple-300",children:"Contact Us"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:["For account issues, bug reports, or questions, email: ",e.jsx("span",{className:"text-blue-400",children:"help.trenddash@gmail.com"})]}),e.jsx("li",{children:"For account deletion requests, mention your registered email and UID."}),e.jsxs("li",{children:["We typically respond within ",e.jsx("strong",{children:"48 hours"}),"."]})]})]})]})]})}function ke(){const{sessionId:d}=Y(),t=M(),[r,p]=a.useState(null),[s,o]=a.useState(!0),[n,b]=a.useState(null),[u,l]=a.useState(null);a.useEffect(()=>{c();const g=setInterval(c,3e4);return()=>clearInterval(g)},[d]);const c=async()=>{try{const g=await fetch(`https://ride-along-api.onrender.com/api/live-location/${d}`);if(g.ok){const w=await g.json();if(w.success&&w.data)p(w.data),l(new Date),b(null);else throw new Error("Invalid response format")}else if(g.status===404)b("Live location session not found or expired");else throw new Error("Failed to fetch location data")}catch(g){console.error("Error fetching location:",g),b(`Live location sharing session not found. This could be because:
• The session has expired
• The link is invalid
• The person stopped sharing their location`)}finally{o(!1)}},j=()=>{if(r&&r.location){const{lat:g,lng:w}=r.location,N=`https://maps.google.com/maps?q=${g},${w}`;window.open(N,"_blank")}},h=()=>{window.location.href="tel:112"};return s?e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:e.jsx("div",{className:"bg-white rounded-lg shadow-md p-8 max-w-md w-full mx-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Loading Live Location..."}),e.jsx("p",{className:"text-gray-600",children:"Fetching real-time location data"})]})})}):n?e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:e.jsx("div",{className:"bg-white rounded-lg shadow-md p-8 max-w-md w-full mx-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"📍"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Location Not Available"}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-gray-700 text-sm whitespace-pre-line",children:n})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>t("/sos"),className:"w-full bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-200",children:"🆘 Go to Emergency SOS"}),e.jsx("button",{onClick:()=>t("/"),className:"w-full bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-200",children:"🏠 Go to Home"})]})]})})}):e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx("div",{className:"bg-red-600 text-white p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"🚨 Emergency Live Location"}),e.jsx("p",{className:"text-red-100",children:"Real-time location tracking"})]}),e.jsx("button",{onClick:h,className:"bg-red-800 hover:bg-red-900 text-white font-bold py-2 px-4 rounded-lg transition duration-200",children:"📞 Call 112"})]})})}),e.jsxs("div",{className:"max-w-4xl mx-auto p-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-2 animate-pulse"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Live Location Active"})]}),u&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Last updated: ",u.toLocaleTimeString()]})]}),r&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"👤 Person Details"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",r.userName||"Unknown"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",r.userEmail||"Not provided"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Started:"})," ",new Date(r.startTime||Date.now()).toLocaleString()]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"📍 Location Details"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Coordinates:"})," ",r.location?.lat?.toFixed(6),", ",r.location?.lng?.toFixed(6)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",r.placeName||"Getting address..."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Accuracy:"})," ",r.accuracy||"Unknown"]})]})]})]})]}),r?.message&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-red-800 mb-2",children:"⚠️ Emergency Message"}),e.jsx("p",{className:"text-red-700",children:r.message})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"📍 Location on Map"}),e.jsx("button",{onClick:j,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200",children:"🗺️ Open in Google Maps"})]}),r?.location?e.jsx("div",{className:"h-96 rounded-lg overflow-hidden",children:e.jsxs(K,{center:[r.location.lat,r.location.lng],zoom:15,style:{height:"100%",width:"100%"},children:[e.jsx(J,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),e.jsx(he,{position:[r.location.lat,r.location.lng],children:e.jsx(xe,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("strong",{children:"🚨 Emergency Location"}),e.jsx("br",{}),r.userName||"Person in need",e.jsx("br",{}),e.jsxs("small",{children:["Updated: ",u?.toLocaleTimeString()]})]})})})]})}):e.jsx("div",{className:"h-96 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-gray-600",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📍"}),e.jsx("p",{children:"No location data available"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("button",{onClick:h,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200",children:"📞 Call Emergency Services"}),e.jsx("button",{onClick:j,disabled:!r?.location,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"🗺️ Directions in Maps"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200",children:"🔄 Refresh Location"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"ℹ️ Instructions"}),e.jsxs("ul",{className:"text-blue-700 text-sm space-y-1",children:[e.jsx("li",{children:"• This page shows real-time location of someone who shared their emergency location"}),e.jsx("li",{children:"• The location updates automatically every 30 seconds"}),e.jsx("li",{children:'• Use "Call Emergency Services" if immediate help is needed'}),e.jsx("li",{children:'• Click "Directions in Maps" to get navigation to their location'}),e.jsx("li",{children:"• Refresh the page to get the latest location update"})]})]})]})]})}function Le(){const{rideId:d}=Y(),t=M(),[r,p]=a.useState(!0),[s,o]=a.useState(null),[n,b]=a.useState(null),[u,l]=a.useState(null);if(a.useEffect(()=>{(async()=>{try{const h=localStorage.getItem("uid");if(!h||!d){l("Missing booking information");return}const g=await fetch(`https://ride-along-api.onrender.com/api/rides/${d}`);if(!g.ok)throw new Error("Ride not found");const w=await g.json(),N=await fetch(`https://ride-along-api.onrender.com/api/bookings/user/${h}`);if(!N.ok)throw new Error("Bookings not found");const k=(await N.json()).find(y=>y.rideId&&y.rideId._id===d);o(w),b(k)}catch(h){console.error("Error fetching booking details:",h),l(h.message)}finally{p(!1)}})()},[d]),r)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 flex items-center justify-center p-4",children:e.jsx("div",{className:"text-white text-xl animate-pulse",children:"Loading booking details..."})});if(u||!s)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-zinc-800 p-8 rounded-xl shadow-2xl max-w-md mx-auto text-white border border-red-500 text-center",children:[e.jsx("div",{className:"text-6xl text-red-500 mb-4",children:"❌"}),e.jsx("h1",{className:"text-2xl font-bold text-red-400 mb-4",children:"Error Loading Details"}),e.jsx("p",{className:"text-gray-300 mb-6",children:u||"Unable to load booking details"}),e.jsx("button",{onClick:()=>t("/"),className:"w-full bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded transition-colors",children:"Go to Home"})]})});const c=new Date(s.departureTime);return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-zinc-800 p-8 rounded-xl shadow-2xl max-w-2xl mx-auto text-white border border-green-500 backdrop-blur-md",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"text-6xl text-green-500 mb-4",children:"✅"}),e.jsx("h1",{className:"text-3xl font-bold text-green-400 mb-2",children:"Booking Confirmed!"}),e.jsx("p",{className:"text-gray-300",children:"Your ride has been booked successfully. Confirmation emails have been sent."})]}),n&&e.jsxs("div",{className:"bg-blue-900 bg-opacity-30 p-4 rounded-lg mb-6 border border-blue-500",children:[e.jsx("h2",{className:"text-xl font-semibold text-blue-300 mb-3",children:"📋 Booking Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsx("div",{children:e.jsx("strong",{children:"Booking ID:"})}),e.jsx("div",{className:"font-mono text-green-400",children:n._id}),e.jsx("div",{children:e.jsx("strong",{children:"Seats Booked:"})}),e.jsx("div",{children:n.seatsBooked}),e.jsx("div",{children:e.jsx("strong",{children:"Total Cost:"})}),e.jsxs("div",{className:"text-green-400 font-bold",children:["₹",n.seatsBooked*s.price]}),e.jsx("div",{children:e.jsx("strong",{children:"Booked At:"})}),e.jsx("div",{children:new Date(n.bookedAt).toLocaleString()})]})]}),e.jsxs("div",{className:"bg-purple-900 bg-opacity-30 p-4 rounded-lg mb-6 border border-purple-500",children:[e.jsx("h2",{className:"text-xl font-semibold text-purple-300 mb-3",children:"🚗 Trip Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Route:"})," ",s.from," → ",s.to]}),s.via&&s.via.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Via:"})," ",s.via.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Date:"})," ",c.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Time:"})," ",c.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Price per seat:"})," ₹",s.price]})]})]}),e.jsxs("div",{className:"bg-green-900 bg-opacity-30 p-4 rounded-lg mb-6 border border-green-500",children:[e.jsx("h2",{className:"text-xl font-semibold text-green-300 mb-3",children:"👨‍🚗 Driver Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",s.driverName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Contact:"}),e.jsx("span",{className:"ml-2 bg-green-700 px-2 py-1 rounded text-green-200 font-mono",children:s.driverContact})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Vehicle:"}),e.jsx("span",{className:"ml-2 bg-green-700 px-2 py-1 rounded text-green-200 font-mono",children:s.vehicleNumber})]})]}),e.jsx("div",{className:"mt-3 p-2 bg-green-800 bg-opacity-50 rounded border-l-4 border-green-400",children:e.jsxs("div",{className:"text-green-200 text-sm",children:["💡 ",e.jsx("strong",{children:"Contact the driver:"})," Reach out before departure to confirm pickup location and any last-minute details."]})})]}),e.jsxs("div",{className:"bg-yellow-900 bg-opacity-30 p-4 rounded-lg mb-6 border border-yellow-500",children:[e.jsx("h2",{className:"text-xl font-semibold text-yellow-300 mb-3",children:"⚠️ Important Notes"}),e.jsxs("ul",{className:"text-sm space-y-1 list-disc list-inside text-yellow-100",children:[e.jsx("li",{children:"Arrive at pickup location 10 minutes early"}),e.jsx("li",{children:"Keep your phone accessible for driver communication"}),e.jsx("li",{children:"You can cancel your booking from your profile page"}),e.jsx("li",{children:"Contact support if you face any issues"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>t("/profile"),className:"w-full bg-green-600 hover:bg-green-700 px-4 py-3 rounded-lg transition-colors font-semibold",children:"View My Bookings"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>t("/search"),className:"bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg transition-colors",children:"Search More Rides"}),e.jsx("button",{onClick:()=>t("/"),className:"bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded-lg transition-colors",children:"Back to Home"})]})]})]})})}function Ce(){const[d,t]=a.useState(null),[r,p]=a.useState(!0),[s,o]=a.useState(!1),n=$(),b=a.useRef(),u=M();a.useEffect(()=>{const j=V(n,async h=>{if(h)try{const g=await h.getIdToken();localStorage.setItem("uid",h.uid),localStorage.setItem("token",g)}catch(g){console.error("Error getting ID token:",g)}else localStorage.removeItem("uid"),localStorage.removeItem("token");t(h),p(!1)});return()=>j()},[n]),a.useEffect(()=>{const j=h=>{b.current&&!b.current.contains(h.target)&&o(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]);const l=async()=>{try{const j=new W;j.setCustomParameters({prompt:"select_account"});const h=await de(n,j),g=await h.user.getIdToken();localStorage.setItem("uid",h.user.uid),localStorage.setItem("token",g)}catch(j){console.error("Login failed:",j)}},c=async()=>{try{await ce(n),localStorage.removeItem("uid"),localStorage.removeItem("token"),o(!1),u("/")}catch(j){console.error("Logout failed:",j)}};return r?e.jsx("div",{className:"text-center mt-10 text-white",children:"Loading..."}):e.jsxs("div",{children:[e.jsxs("nav",{className:"p-4 bg-blue-600 text-white flex justify-between items-center",children:[e.jsxs(T,{to:"/",className:"flex items-center gap-2",children:[e.jsx("img",{src:"/logo.png",alt:"Ride Along Logo",className:"h-10"}),e.jsx("span",{className:"font-bold text-xl",children:"Ride Along"})]}),e.jsxs("div",{className:"flex items-center gap-4 relative",ref:b,children:[e.jsx(T,{to:"/post",className:"hover:underline",children:"Post Ride"}),e.jsx(T,{to:"/search",className:"hover:underline",children:"Search"}),e.jsx(T,{to:"/sos",className:"bg-red-600 hover:bg-red-700 px-3 py-1 rounded text-white font-semibold transition",children:"🆘 SOS"}),d?e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>o(!s),className:"bg-white text-blue-600 font-semibold px-3 py-1 rounded hover:bg-blue-100 transition",children:[d.displayName?.split(" ")[0]||"User"," ⌄"]}),s&&e.jsxs("div",{className:"absolute right-0 mt-2 w-52 bg-white text-blue-700 rounded shadow-lg z-50 animate-fade-in-down",children:[e.jsx(T,{to:"/profile",onClick:()=>o(!1),className:"block px-4 py-2 hover:bg-blue-100 transition",children:"👤 Profile"}),e.jsx(T,{to:"/sos",onClick:()=>o(!1),className:"block px-4 py-2 bg-red-50 text-red-700 hover:bg-red-100 transition font-semibold",children:"🆘 Emergency SOS"}),e.jsx("hr",{className:"my-1"}),e.jsx(T,{to:"/terms",onClick:()=>o(!1),className:"block px-4 py-2 text-sm hover:bg-blue-100 transition",children:"📜 Terms & Conditions"}),e.jsx(T,{to:"/privacy",onClick:()=>o(!1),className:"block px-4 py-2 text-sm hover:bg-blue-100 transition",children:"🔒 Privacy Policy"}),e.jsx(T,{to:"/refund",onClick:()=>o(!1),className:"block px-4 py-2 text-sm hover:bg-blue-100 transition",children:"💸 Refund Policy & Contact"}),e.jsx("hr",{className:"my-1"}),e.jsx("button",{onClick:c,className:"w-full text-left px-4 py-2 hover:bg-blue-100 transition",children:"🚪 Logout"})]})]}):e.jsx("button",{onClick:l,className:"bg-white text-blue-600 px-3 py-1 rounded font-semibold hover:bg-blue-100 transition",children:"Login with Google"})]})]}),e.jsxs(ae,{children:[e.jsx(I,{path:"/",element:e.jsx(be,{})}),e.jsx(I,{path:"/post",element:e.jsx(Z,{})}),e.jsx(I,{path:"/search",element:e.jsx(X,{})}),e.jsx(I,{path:"/ride/:id",element:e.jsx(fe,{})}),e.jsx(I,{path:"/profile",element:e.jsx(ye,{})}),e.jsx(I,{path:"/sos",element:e.jsx(ve,{})}),e.jsx(I,{path:"/booking-success/:rideId",element:e.jsx(Le,{})}),e.jsx(I,{path:"/live-location/:sessionId",element:e.jsx(ke,{})}),e.jsx(I,{path:"/terms",element:e.jsx(Ne,{})}),e.jsx(I,{path:"/privacy",element:e.jsx(we,{})}),e.jsx(I,{path:"/refund",element:e.jsx(Se,{})})]})]})}const Ee=a.createContext(),Pe=({children:d})=>{const[t,r]=a.useState(null),[p,s]=a.useState(!0);return a.useEffect(()=>{const o=V(Q,async n=>{if(n)try{const b=await n.getIdToken();localStorage.setItem("uid",n.uid),localStorage.setItem("token",b),r(n)}catch(b){console.error("Error getting ID token:",b),r(n)}else localStorage.removeItem("uid"),localStorage.removeItem("token"),r(null);s(!1)});return()=>o()},[]),e.jsx(Ee.Provider,{value:{user:t,loading:p},children:!p&&d})};q.createRoot(document.getElementById("root")).render(e.jsx(re.StrictMode,{children:e.jsx(ne,{children:e.jsx(Pe,{children:e.jsx(Ce,{})})})}));
